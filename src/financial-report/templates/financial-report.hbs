<html lang='pt-BR'>

  <head>
    <meta charset='UTF-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0' />
    <title>Relatório Financeiro - ConGa</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
        background: #f5f5f5;
        padding: 20px;
        color: #000;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      }

      .report-header {
        padding: 30px 35px 25px;
        border-bottom: 2px solid #000;
      }

      .logo-area {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 20px;
      }

      .logo-image {
        width: 40px;
        height: 40px;
        object-fit: contain;
      }

      .system-name {
        font-size: 18px;
        font-weight: 600;
        color: #000;
      }

      .report-title {
        font-size: 16px;
        font-weight: 600;
        color: #000;
        margin-bottom: 3px;
      }

      .report-period {
        font-size: 12px;
        color: #666;
        margin-bottom: 15px;
      }

      .report-meta {
        font-size: 11px;
        color: #666;
        line-height: 1.6;
      }

      .section {
        padding: 25px 35px;
        border-bottom: 1px solid #e0e0e0;
        page-break-inside: avoid;
      }

      .section-title {
        font-size: 14px;
        color: #000;
        margin-bottom: 15px;
        font-weight: 600;
      }

      .metric-list {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .metric-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-bottom: 12px;
        border-bottom: 1px solid #f0f0f0;
      }

      .metric-item:last-child {
        border-bottom: none;
        padding-bottom: 0;
      }

      .metric-label {
        font-size: 13px;
        color: #000;
        font-weight: 400;
      }

      .metric-value {
        font-size: 13px;
        color: #000;
        font-weight: 400;
      }

      .table-section {
        margin-top: 20px;
        page-break-inside: avoid;
      }

      .data-table {
        width: 100%;
        border-collapse: collapse;
      }

      .data-table thead {
        border-bottom: 1px solid #e0e0e0;
      }

      .data-table th {
        padding: 10px 0;
        text-align: left;
        font-size: 11px;
        color: #666;
        font-weight: 600;
      }

      .data-table td {
        padding: 12px 0;
        border-bottom: 1px solid #f5f5f5;
        color: #000;
        font-size: 12px;
      }

      .data-table tbody tr:last-child td {
        border-bottom: none;
      }

      .badge {
        padding: 3px 8px;
        border-radius: 3px;
        font-size: 10px;
        font-weight: 500;
        display: inline-block;
      }

      .badge-receita {
        background: #f5f5f5;
        color: #333;
      }

      .badge-despesa {
        background: #f5f5f5;
        color: #333;
      }

      .chart-container {
        background: white;
        padding: 0;
        height: 250px;
        margin-top: 15px;
      }

      .comparison-info {
        font-size: 12px;
        color: #666;
        margin-bottom: 10px;
        text-align: center;
      }

      .comparison-info span {
        font-weight: 600;
        color: #000;
      }

      .positive-value {
        color: #2ecc71;
        font-weight: 600;
      }

      .negative-value {
        color: #e74c3c;
        font-weight: 600;
      }

      .report-footer {
        padding: 20px 35px;
        text-align: center;
        font-size: 10px;
        color: #999;
        border-top: 1px solid #e0e0e0;
      }

      .btn-pdf:hover {
        background: #357abd;
      }

      .btn-pdf:disabled {
        background: #ccc;
        cursor: not-allowed;
      }

      @media print {
        body {
          background: white;
          padding: 0;
          margin: 0;
        }

        .container {
          box-shadow: none;
          max-width: 100%;
          margin: 0;
          padding: 0;
        }

        .pdf-button-section {
          display: none;
        }

        .section {
          page-break-inside: avoid;
        }

        .table-section {
          page-break-inside: avoid;
        }

        .report-header {
          page-break-after: avoid;
        }
      }

      @media (max-width: 768px) {
        .report-header,
        .section,
        .report-footer {
          padding-left: 20px;
          padding-right: 20px;
        }
      }
    </style>
  </head>

  <body>
    <div class='container'>
      <div class='report-header'>
        <div class='logo-area'>
          <img
            src='data:image/png;base64,{{logoBase64}}'
            alt='ConGa Logo'
            class='logo-image'
          />
          <div class='system-name'>ConGa</div>
        </div>
        <h1 class='report-title'>Relatório Financeiro</h1>
        <p class='report-period'>Período:
          <span id='periodoRelatorio'>{{formatPeriodShort
              period.dateFrom
              period.dateTo
            }}</span>
        </p>
        <div class='report-meta'>
          <div>Gerado em:
            {{formatDateTime generatedAt}}<span id='dataGeracao'></span></div>
          <div>Responsável: Sistema ConGa</div>
        </div>
      </div>
      <div class='section'>
        <h2 class='section-title'>Resumo Executivo</h2>
        <div class='metric-list'>
          <div class='metric-item'>
            <span class='metric-label'>Receita Total</span>
            <span class='metric-value' id='receitaTotal'>
              {{money overview.totalReceives}}</span>
          </div>
          <div class='metric-item'>
            <span class='metric-label'>Despesa Total</span>
            <span class='metric-value' id='despesaTotal'>
              {{money overview.totalExpenses}}</span>
          </div>
          <div class='metric-item'>
            <span class='metric-label'>Lucro Líquido Total</span>
            <span class='metric-value' id='lucroTotal'>
              {{money overview.periodResult}}</span>
          </div>
        </div>
      </div>
      <div class='section'>
        <h2 class='section-title'>Detalhamento por categoria</h2>
        <div class='table-section'>
          <table class='data-table'>
            <thead>
              <tr>
                <th>Categoria</th>
                <th>Tipo</th>
                <th style='text-align: right;'>Valor</th>
              </tr>
            </thead>
            <tbody id='tabelaTransacoes'>
              <tr>
                <td>Custos com Pessoal</td>
                <td>Despesas</td>
                <td style='text-align: right;'>{{money detail.personnel}}</td>
              </tr>
              <tr>
                <td>Insumos</td>
                <td>Despesas</td>
                <td style='text-align: right;'>{{money detail.supplies}}</td>
              </tr>
              <tr>
                <td>Utilidades</td>
                <td>Despesas</td>
                <td style='text-align: right;'>{{money detail.utility}}</td>
              </tr>
              <tr>
                <td>Operacional</td>
                <td>Despesas</td>
                <td style='text-align: right;'>{{money detail.operational}}</td>
              </tr>
              <tr>
                <td>Produção de Leite Local</td>
                <td>Receitas</td>
                <td style='text-align: right;'>{{decimal
                    detail.localProduction
                  }}
                  L</td>
              </tr>
              <tr>
                <td>Produção dos Produtores</td>
                <td>Receitas</td>
                <td style='text-align: right;'>{{decimal
                    detail.producerProduction
                  }}
                  L</td>
              </tr>
              <tr>
                <td>Produção Total do Tanque</td>
                <td>Receitas</td>
                <td style='text-align: right;'>{{sum
                    detail.producerProduction
                    detail.localProduction
                  }}
                  L</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class='section'>
        <h2 class='section-title'>Evolução ao Longo do Período</h2>
        <div class='table-section'>
          <table class='data-table'>
            <thead>
              <tr>
                <th>Dia</th>
                <th style='text-align: right;'>Receita</th>
                <th style='text-align: right;'>Despesa</th>
                <th style='text-align: right;'>Lucro</th>
              </tr>
            </thead>
            <tbody id='tabelaEvolucao'>
              {{#each daily}}
                <tr>
                  <td>{{date this.date}}</td>
                  <td style='text-align: right;'>{{money this.receives}}</td>
                  <td style='text-align: right;'>{{money this.expenses}}</td>
                  <td style='text-align: right;'>{{money
                      (profit this.receives this.expenses)
                    }}</td>

                </tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      </div>
      </div>
      <div class='report-footer'>
        ConGa - Sistema de Controle e Gestão para Pecuária Leiteira © 2025
      </div>
    </div>
  </body>

</html>